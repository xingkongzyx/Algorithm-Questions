""" 
> è¿™é“é¢˜éš¾ç‚¹åœ¨äºå¼„æ˜ç™½ "ä¸ºä»€ä¹ˆäºŒåˆ†æŸ¥æ‰¾å¾—åˆ°çš„ç»“æœä¸€å®šåœ¨çŸ©é˜µä¸­"
* æˆ‘ä»¬å…ˆçœ‹ getCount å‡½æ•°. getCount å‡½æ•°çš„ç›®çš„æ˜¯ç»Ÿè®¡çŸ©é˜µé‡Œå°ç­‰äº mid çš„å…ƒç´ æ•°ç›®count. å†åˆ¤æ–­count å’Œ kçš„å…³ç³».å› ä¸º mid = (l + r) / 2 è¿™ç§åˆ’åˆ†æ–¹æ³•æ˜¯æŠŠçŸ©é˜µåˆ’åˆ†æˆäº†[left , mid] ä¸[mid + 1, right] ä¸¤éƒ¨åˆ†. å½“ count < k æ—¶, è¯´æ˜ mid å¤ªå°äº†, æˆ‘ä»¬åº”è¯¥åœ¨ [mid + 1, right] è¿™ä¸ªèŒƒå›´é‡ŒæŸ¥æ‰¾. å¦åˆ™åœ¨ [left, mid] èŒƒå›´é‡ŒæŸ¥æ‰¾.
* å¦‚æœå­˜åœ¨ä¸€ä¸ªä¸åœ¨çŸ©é˜µä¸­çš„æ•° a æ»¡è¶³æ¡ä»¶(çŸ©é˜µä¸­å°äºç­‰äº mid çš„æ•°æ­£å¥½æœ‰ k ä¸ª), å› ä¸º a ä¸åœ¨çŸ©é˜µä¸­,é‚£ count ç»Ÿè®¡çš„å…ƒç´ è‚¯å®šéƒ½æ˜¯å°äº a çš„(å› ä¸º count ç»Ÿè®¡çš„æ˜¯åœ¨çŸ©é˜µä¸­çš„å…ƒç´ , è€Œ a ä¸åœ¨çŸ©é˜µä¸­), âœŒ é‚£ä¸€å®šå­˜åœ¨ä¸€ä¸ªæ¯” a å°ä¸”åœ¨çŸ©é˜µä¸­çš„æ•° b æ»¡è¶³æ¡ä»¶, å³ä»å°äº a çš„æ•°å˜æˆäº†å°äºç­‰äº b çš„æ•°. âœŒ ç­‰ç”¨é¢˜ç›®ä¸­çš„ä¾‹å­, x = 13 å’Œ x = 14 éƒ½æ»¡è¶³å°äºç­‰äº x çš„å…ƒç´ æ•°ç›®ç­‰äº 8, å¯¹ 14 æ¥è¯´ç»Ÿè®¡çš„æ˜¯å°äºå®ƒçš„æ•°(å› ä¸ºå®ƒä¸åœ¨çŸ©é˜µä¸­), è€Œå¯¹13æ¥è¯´ç»Ÿè®¡çš„éƒ½æ˜¯å°äºç­‰äºå®ƒçš„æ•°(å› ä¸º13åœ¨çŸ©é˜µä¸­). é—®é¢˜æ¥äº†, é‚£ä¸ºä½•å–åˆ°çš„ä¸æ˜¯ 14 è€Œæ˜¯ 13 å‘¢?
# ğŸ‘‘ å› ä¸ºæˆ‘ä»¬å–midçš„å–æ³•æ˜¯ mid = (left + right) / 2, å½“ left < rightæ—¶, mid æ°¸è¿œ å–ä¸åˆ°right, æƒ³è¦midå–åˆ°right ,åªæœ‰left == right. ä½†å¾ªç¯æ¡ä»¶æ˜¯ while(left < right), å½“ left == rightæ—¶å¾ªç¯å·²ç»ç»ˆæ­¢.  æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ä¼šæ˜¯ä¸€ä¸ªå·¦è¾¹ç•Œ. è¿˜æ˜¯ç”¨é¢˜ç›®ä¸­çš„ä¾‹å­, å‡è®¾left = 13, right = 14 åˆ™ mid = (13 + 14) / 2 = 13

? æ¥è‡ªåº•ä¸‹JOxygençš„è¯„è®º: https://leetcode.cn/problems/kth-smallest-element-in-a-sorted-matrix/solution/you-xu-ju-zhen-zhong-di-kxiao-de-yuan-su-by-leetco/

/ æˆ–è€…è¯´åœ¨ [left, right] ä¸­ç¬¦åˆæ¡ä»¶ - "count(çŸ©é˜µä¸­å°äºç­‰äºå®ƒçš„æ•°)==k" çš„æ•°å¯èƒ½ä¼šæœ‰å¤šä¸ª, è¿™äº›æ•°ä¸­, æœ€å°çš„é‚£ä¸ª(è®¾ä¸ºa)ä¸€å®šåœ¨çŸ©é˜µä¸­(è§ä¸Šé¢è¯´æ˜), å¯¹äºä»»æ„æ•´æ•°i(i<a) , count(i)<k, ç›´åˆ°iç­‰äºaæ—¶, countå°†ç¬¬ä¸€æ¬¡ç­‰äºkã€‚å¦‚æœå…ˆå‡ºç°äº† count(mid)==k å¹¶ä¸” mid ä¸åœ¨ matrix ä¸­ä¸”å¤§äº a, äºŒåˆ†æœç´¢å¹¶ä¸ä¼šåœæ­¢è€Œæ˜¯è€Œæ˜¯ç¼©å°æœç´¢åŒºé—´ä¸º [left, mid], å› ä¸ºè¿™é‡Œçš„äºŒåˆ†æœç´¢çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿ count==k çš„ä½ç½®ã€‚è€Œç¬¬ä¸€ä¸ªä½ç½®ä¸€å®šæ˜¯ matrix æœ¬èº«çš„ä¸€ä¸ªå…ƒç´  a

# ä¸ºä»€ä¹ˆå¤§äºç­‰äºä¸€èµ·åˆ¤æ–­, å°äºå•ç‹¬è¿›è¡Œåˆ¤æ–­? ç”±äºcountå¤§äºk ä¹Ÿå¯èƒ½æˆ‘ä»¬é€‰æ‹©çš„å€¼æ˜¯æ­£å¥½çš„ï¼Œ å› æ­¤è¿™é‡Œä¸èƒ½è°ƒæ•´ä¸ºmid - 1ï¼Œ å¦åˆ™å¯èƒ½ä¼šå¾—ä¸åˆ°ç»“æœ
? https://leetcode.cn/problems/kth-smallest-element-in-a-sorted-matrix/solution/er-fen-cha-zhao-378-you-xu-ju-zhen-zhong-di-kxiao-/
? æˆ–è€…çœ‹è‹±æ–‡ç‰ˆçš„å¸–å­: https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/discuss/1322101/C%2B%2BJavaPython-MaxHeap-MinHeap-Binary-Search-Picture-Explain-Clean-and-Concise 

* æ—¶é—´å¤æ‚åº¦: O(n * log(r-l)), äºŒåˆ†æŸ¥æ‰¾è¿›è¡Œæ¬¡æ•°ä¸º O(log(r-l)), æ¯æ¬¡æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚r å’Œ l åˆ†åˆ«ä»£è¡¨çŸ©é˜µçš„æœ€å¤§å€¼å’Œæœ€å°å€¼
* ç©ºé—´å¤æ‚åº¦: O(1)ã€‚
"""


class Solution:
    def kthSmallest(self, matrix, k) -> int:
        left = matrix[0][0]
        right = matrix[-1][-1]

        while left < right:
            mid = left + (right - left) // 2
            print(left, right, mid)
            # * å¾—åˆ°matrixä¸­å°äºç­‰äº mid çš„æ•°æœ‰å¤šå°‘ä¸ª
            count = self.getCount(matrix, mid)
            print(f"mid is {mid}, there are {count} elements <= mid")
            # * å¦‚æœ "å¤§äº k" åˆ™è¯´æ˜ midåŠå…¶å³è¾¹ä¸€å®šä¸åŒ…å« kth smallest element, ä¸‹ä¸€è½®æœç´¢åŒºé—´æ˜¯ [left, mid - 1]
            if count >= k:
                right = mid
            else:
                left = mid + 1

        return left

    # / å¯»æ‰¾ matrix ä¸­ "å°äºç­‰äº target" çš„å…ƒç´ æ•°é‡
    def getCount(self, matrix, value):
        # * ä»¥è¡Œä¸ºå•ä½æ‰¾, æ‰¾åˆ°æ¯ä¸€è¡Œæœ€åä¸€ä¸ª <=mid çš„æ•°å³çŸ¥é“è¿™ä¸€è¡Œæœ‰å¤šå°‘ä¸ªæ•° <=mid
        i = 0
        j = len(matrix[0]) - 1
        count = 0
        while i < len(matrix) and j >= 0:
            if matrix[i][j] <= value:
                # // ç¬¬ i è¡Œæœ‰ j+ 1 ä¸ªå…ƒç´  <=mid
                count += j + 1
                i += 1
            else:
                j -= 1
        return count


print(Solution().kthSmallest(
    matrix=[[1, 5, 9], [10, 11, 13], [12, 13, 18]], k=8))
